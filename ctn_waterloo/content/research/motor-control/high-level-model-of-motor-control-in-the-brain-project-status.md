title: High level model of motor control in the brain: Project status

### Tasks to do

  * Separate the high level control model into separate brain areas based on high level neuroanatomical model.
  * Examine methods of adding gradient cost near constraints in probablity matrices for efficient computation of optimal actions algorithm.

###  Progress

**11/19/2009** - Remade the control diagram to fit with the efficient inverse algorithms (really need a goddamned proper name for that) model, will set up tests tomorrow to see how it compares to people who have lesions to the areas etc etc. [ ![](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/control+diagram+-+effinv.jpg) ](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/control+diagram+-+effinv.jpg) **11/10/2009** - WRITING **10/21/2009** - Still working on implementing efficient computations for optimal control algorithm, adding some basic constraints to the proabability matrices right now, so that the next state doesn't just go right off the map of possible next states. Control and pasive probability matrices are ready to go once that's done, and will begin testing the cost and cost-to-go functions l and v, respectively. Once those are calculated then it's just computing the desirability function (exp(-v)) and u* = p(.|x)z(x') / G[z](x) where x is current state and x' is next state. G is the normalization term. Here goes! **10/13/2009** - Fixed the xdot_x and xdot_u calculation problem. It was looking for the high level A and B matrices, not the low level ones that were being fed in to it, so the matrix H is calculated as [J 0 ; dJ J] where J is the jacobian and dJ its derivative, and then xdot_x = H*A and xdot_u = H*B. More appropriately it would be ydot_y and y_dot_v though. All the same, results are greatly improved and I can sleep at night again. Now looking into efficiently creating and working with sparse matrices in MATLAB. Yeah dogg. **10/11/2009** - Have run into a problem with developing the model using the inverse algorithm method Todo describes in Efficient Algorithms for Inverse Optimal Control, the matrices required are sparse (50 entries per row-ish) 20,000,000 x 20,000,000 matrices. Curious about the biological plausibility. Even working on a grid that is 6x6 Matlab can't handle the computations. So I'm not exactly sure what to do. Looking for a solution. **10/6/2009** - Constraints implemented, but not tested very much. Have been getting some crazy responses from the iLQG code with particular starting values and the such, and there is an issue with calculating xdot_x and xdot_u, he uses the finite differences method to do it, and it doesn't work particularily well with my low level model, I'm not sure exactly why. I will have to look into it more, I believe it's because of the linearity of the model, but not certain. But iLQG isn't the control I want to implement anyways, so moving on to Efficient Computation of Optimal Actions and Inverse Algorithms papers. **10/04/2009** - Have implemented hierarchical controllers for a simple 2D arm model guided at the top level by the optimal iLQG method code from Todo's website. There are no constraints implemented on the model's low level or included in the cost function at the high level at the moment, working on that now. **9/25/2009** - Reading thorugh 'Motor Cortex in Voluntary Movements', it has some interesting facts. Like the PM has at least as many corticomotor neurons at M1. I don't know what to do with that yet. Developed a conscious correction model a couple of days ago, here is the initial version: [ ![](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/conscious+correction.jpg) ](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/conscious+correction.jpg) Right now reading through inertia matrices, from the start, to finish up my high level model of a simple arm model. **9/17/2009** - Control model! Huzzah. Check this: [ ![](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/control+diagram.jpg) ](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/control+diagram.jpg) That's my model. Work on implementing begins with this model however, effectively removing the simple planning controller in M1 from the loop: [ ![](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/control+diagram+-+simplified.jpg) ](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/control+diagram+-+simplified.jpg) **9/14/2009** - Have developed high level brain model. Here it is in all its confusing glory! Note: there are some missing connections, I'll update it here soon with a better version. [ ![](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/Motor+Control+System.jpg) ](http://compneuro.uwaterloo.ca/cnrglab/?q=system/files/Motor+Control+System.jpg) Click on it to see it big size. Control model to follow. **8/3/2009** - Found 'Kinematics of Human Movement', explains in 10 pages what has taken me a long time to work out by myself. Initial high level system model has been developed, low level cost function estimator created, hopefully they should be dead on too, using the same methods Todo used in the frequently referenced 7dof paper. Next step is high level control signal optimization, Todo uses the iterative LQG method of his, so I am now to look into that. **7/29/2009** - Inertial matrices are the devil. But they are much better than parameter optimization, I hate using numerical methods in lieu of analysis. Information on this is hard to find on the web, I am to look into kin books again. **7/26/2009** - Parameter optimization is the devil. Looking at Todo's 7dof paper again he also does not use this method to find his high level system model or control cost estimation, he does it analytically. I throw gradient descent aside and will now follow this path. **7/20/2009** - Parameter optimization is killing me. Lots of reading about choosing an appropriate function and optimization methods. All hails matlab. **7/13/2009** - Todo is the man. He has two papers out talking about his new controller design, one is a difficult read, Efficient algorithms for inverse optimal control; the other is much nicer, entitled Parallels between sensory and motor information processing. Looking now at implementing the lower level dynamics with an optimal controller designed in the fashion described therein, learning lots about Bayes theorem and probability. **7/8/2009** - Looking through Todo's paper detailing his 7DOF arm controller, there is lots of funky stuff involving Jacobians and matrices to work through that is slowing me down, but I think I've got it. The next steps involve designing the optimal low level controller and then designing the high level dynamics. Todo has a new paper out talking about new controller designing methods, let the reading begin. **6/30/2009** - Working through Todorov's paper, this is a really impressive setup. Can more explicitly model the passive dynamics of the system using a function a(x) instead of matrix A*x, keeping the modeled control-dependent dynamics linear, however. Lower-level joint-angle controller modified to directly relate end-effector velocity to joint-torque. designing higher level end-effector position controller will require analysis of the lower level dynamics. Lots of data collection and analysis ahead. Todorov suggest using supervised learning to find good function parameters. Will investigate. **6/28/2009** - Controller uses torque, and optimizes based on the given control function, however it does not resemble human arm movement because it moves in an arc to the target, not in a straight line. Todorov discusses in his paper From Task Parameters to Motor Synergies a hierarchical set of controllers where the bottom controller controls torque and the top level controller controls effector position, resulting in a system that reaches in a fashion similar to primates. I am hoping to have this system implemented by week's end. **6/19/2009** - Built linear controller for 2-link 2d arm model, works for points in the first quadrant, attempt to reach points in the second quadrant by going clockwise. Which definitely is not a good idea. Again, lots of fun things to play with, if the poles of the system are too far in the LHP and there is an overshoot when reaching for target it is unable to return and shakes humoroursly indefinitely. Investigating ways to reach points in the 2nd quadrant. ** one hour later ** - problem solved, I didn't copy over a section of code from my inverse kinematics function. To solve for the angles everything has to be between pi/2 and -pi/2, so to put things back in the > pi/2 or < -pi/2 range you just subtract the found angles from pi. Easy as. **6/18/09** - Reading continues, going well. Also trying to get the write-up of the single-link controller completed in the next day or two. The work from Mussa-Ivaldi on force fields in frogs came to mind today and I wonder how using those as the motor primitives of the system could alter the dynamics, searching for a paper on the subject begins. **6/15/2009** - My old control systems prof David Miller suggested that I read the Spong & Hutchinson 'Robot Modeling and Controlling' book, downloaded the pdf from scribd (high-fives) and started reading through. They don't develop a linear model of the arm here, there's a lot of other stuff going on, hoping that layered linear controllers can replicate non-linear controllers. There is lots of math ahead. **6/13/2009** - Started working through Mathematica, it's pretty solid for symbolic logic but the syntax is a pain in the ass a lot of the time. I've found some examples online of inverse kinematics worked out in 3-D arms at http://demonstrations.wolfram.com/InverseKinematics/ which is pretty neat. Clearly there is a lot of power in Mathematica, and that arm looks waaaayyyy prettier than the 2 lines and the circle I have representing my arm. Found the error in the code and fixed it, updated the website, I think I removed all the comments I had made to myself throughout it. Focusing on developing a controller for the system now. **6/4/2009** - Working through the physics of the 2-Link controller from the code posted on the CNRG website, somewhere there is an error in that a '+' is a '-' or visa-versa. **5/28/2009** - After examining the effects of varying the cost functions I've arrived at a set of cost functions that works fairly well for the system, although the difference from the controller that doesn't compensate for noise isn't as much as I would like, I think that once more complexity is added with the second link the difference will become significant. **5/21/2009** - Adjusting the cost functions has brought the LQG regulator to perform better than a controller that doesn't compensate for noise, but it's still much closer than I think it should be. I could be wrong, reading on cost function matrices weighting begins. **5/19/2009** - Implemented simulation and controller as specified in Athan's paper (page 550). Having difficulty specifying the spectral density matrices that describe the white noise, which I think is the cause for the LQG regulator performing poorer than the controller which doesn't try to compensate for the white noise. Could also be the cost function being optimized by the regulator. Investigation continues. **5/8/2009** - Back from week vacation, continuing to read through Athans's paper. The mathematical description of Gaussian white noise has slowed me down, but working through it. Have been reading 'Linear System Theory and Design' as well, have to read more about model matching, where the system is instantly able to track any input signal, and it's applicability/plausibility for an arm control omdel. Recently discovered www.scribd.com, where I downloaded the book. It's a fantastic resource for books and articles. **4/29/2009** - Found paper "The role and use of the stochastic Linear-Quadratic-Gaussian problem in control system design" by Michael Athans (it's linked on my readings page), goes through the reasoning and derivation of a lot of things in detail, and it is very well written and relevant even though it was written in 1971. **4/28/2009** - Matlab has been giving me difficulties. It doesn't properly factor transfer functions for some reason, I think it has to do with the order that the coefficients are represented between the 'tf' and 'conv' functions. For some reason transfer functions in Matlab order their coefficients opposite of every other functions, that might be causing a problem somewhere. So all transfer functions must be simplified before being used. **4/23/2009** - Implemented simple controller for 1-link arm model in matlab. Handles load variations well, but it's only chance the transfer function deals well with step-input for the reference signal.
